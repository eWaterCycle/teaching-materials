
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Exercise 3: Run HBV model with ERA5 forcing and GRDC observation &#8212; Teaching Material on Hydrological Modelling used in ENVM1502 course at Delft University of Technology</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/thebe.css?v=9bca0c2f" />
    <link rel="stylesheet" type="text/css" href="../_static/code.css?v=4bf7ba55" />
    <link rel="stylesheet" type="text/css" href="../_static/image_dark_mode.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/fix_admonition_style.css?v=8627ce31" />
    <link rel="stylesheet" type="text/css" href="../_static/fix_dropdown_style.css?v=f3461767" />
    <link rel="stylesheet" type="text/css" href="../_static/fix_code_header_style.css?v=7d542921" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script defer="defer" src="../_static/refresh.js?v=9bea9b76"></script>
    <script>const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script defer="defer" src="../_static/sphinx-thebe-lite.js?v=2a71eeb1"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '2_modelling_advanced_ewatercycle/exercise3_run_HBV_eWaterCycle-once';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="canonical" href="https://github.com/eWaterCycle/teaching-materials/2_modelling_advanced_ewatercycle/exercise3_run_HBV_eWaterCycle-once.html" />
    <link rel="icon" href="../_static/TB_favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Exercise 4: Calibrate HBV model with ERA5 forcing and GRDC observation" href="exercise4_calibrate_HBV_eWaterCycle.html" />
    <link rel="prev" title="Exercise 2. Generate forcing for any region from ERA5 for HBV model" href="exercise2_generate_ERA5_forcing_for_HBV.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
    <meta name="docbuild:last-update" content="February 4, 2025"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Teaching Material on Hydrological Modelling used in ENVM1502 course at Delft University of Technology</p>
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Lumped Models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../1_modelling_intro_HBV/Exercise1.html">Modelling exercise 1: Linear Reservoir</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_modelling_intro_HBV/Exercise2.html">Models Exercise 2: Lumped Conceptual Model</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">eWaterCycle platform</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="exercise1_build_test_HBV_eWaterCycle.html">Exercise 1. Test your own HBV model on eWaterCycle</a></li>
<li class="toctree-l1"><a class="reference internal" href="exercise2_generate_ERA5_forcing_for_HBV.html">Exercise 2. Generate forcing for any region from ERA5 for HBV model</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Exercise 3: Run HBV model with ERA5 forcing and GRDC observation</a></li>
<li class="toctree-l1"><a class="reference internal" href="exercise4_calibrate_HBV_eWaterCycle.html">Exercise 4: Calibrate HBV model with ERA5 forcing and GRDC observation</a></li>

<li class="toctree-l1"><a class="reference internal" href="exercise5_generate_CMIP6_forcing_for_HBV.html">Exercise 5: Generate forcing for any region from CMIP6 for HBV model</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">advanced FlexTopo</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../3_modelling_advanced_flextopo/exercise6_flextopo.html">Exercise Flextopo</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">additional info</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Credits and License</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://ewc231stud2.ewatercycle-tud.src.surf-hosted.nl/jupyter/hub/user-redirect/git-pull?repo=https%3A//github.com/eWaterCycle/teaching-materials&urlpath=lab/tree/teaching-materials/2_modelling_advanced_ewatercycle/exercise3_run_HBV_eWaterCycle-once.ipynb&branch=master" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on JupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="JupyterHub logo" src="../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/eWaterCycle/teaching-materials" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/eWaterCycle/teaching-materials/issues/new?title=Issue%20on%20page%20%2F2_modelling_advanced_ewatercycle/exercise3_run_HBV_eWaterCycle-once.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/2_modelling_advanced_ewatercycle/exercise3_run_HBV_eWaterCycle-once.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Exercise 3: Run HBV model with ERA5 forcing and GRDC observation</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analyse-results">Analyse results</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="exercise-3-run-hbv-model-with-era5-forcing-and-grdc-observation">
<h1>Exercise 3: Run HBV model with ERA5 forcing and GRDC observation<a class="headerlink" href="#exercise-3-run-hbv-model-with-era5-forcing-and-grdc-observation" title="Link to this heading">#</a></h1>
<p>In this notebook you will run your own HBV model using ERA5 forcing data (from the previous notebook) and GRDC observation data. You will have to change a few settings below. Read carefully and decide which inputs and lines you need to change.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#load all dependencies, including your own model through ewatercycle_wrapper_HBV</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ewatercycle.forcing</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ewatercycle.observation.grdc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ewatercycle.analysis</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cartopy.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">shapereader</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rich</span><span class="w"> </span><span class="kn">import</span> <span class="nb">print</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">ewatercycle_wrapper_HBV</span><span class="w"> </span><span class="kn">import</span> <span class="n">HBV</span>
 
</pre></div>
</div>
</div>
</div>
<p>Add the name of your region in the cell below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#name of your shapefile/region without extension:</span>
<span class="n">own_region</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1">#for example: &quot;Rhine&quot;</span>

<span class="k">if</span> <span class="n">own_region</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># if nothing is provided, the Rhine shapefile will be used</span>
    <span class="n">own_region</span> <span class="o">=</span> <span class="s2">&quot;Rhine&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#shapefile that describes the basin we want to study.</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span>
<span class="n">forcing_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;Forcing&quot;</span>
<span class="n">shapeFile</span> <span class="o">=</span> <span class="n">forcing_path</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">own_region</span><span class="si">}</span><span class="s2">.shp&quot;</span>

<span class="c1">#location to saved forcing results from previous notebook</span>
<span class="n">forcingLocation</span> <span class="o">=</span> <span class="n">forcing_path</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">own_region</span><span class="si">}</span><span class="s2">Forcing2000-2002&quot;</span>

<span class="c1">#GRDC station ID for the observation station</span>
<span class="n">grdc_station_id</span> <span class="o">=</span> <span class="s2">&quot;6335020&quot;</span>  <span class="c1"># GRDC station ID</span>
<span class="n">basin_name</span> <span class="o">=</span> <span class="n">own_region</span>

<span class="c1">#period of interest. Make sure that GRDC data is available for this period and that.</span>
<span class="n">experiment_start_time</span><span class="o">=</span><span class="s2">&quot;2000-01-01T00:00:00Z&quot;</span>
<span class="n">experiment_end_time</span><span class="o">=</span><span class="s2">&quot;2002-12-31T00:00:00Z&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>Forcing was created in the previous notebook and loaded here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ERA5_forcing</span> <span class="o">=</span> <span class="n">ewatercycle</span><span class="o">.</span><span class="n">forcing</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="s2">&quot;LumpedMakkinkForcing&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">forcingLocation</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ERA5_forcing</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">LumpedMakkinkForcing</span><span style="font-weight: bold">(</span>
    <span style="color: #808000; text-decoration-color: #808000">start_time</span>=<span style="color: #008000; text-decoration-color: #008000">'2000-01-01T00:00:00Z'</span>,
    <span style="color: #808000; text-decoration-color: #808000">end_time</span>=<span style="color: #008000; text-decoration-color: #008000">'2002-12-31T00:00:00Z'</span>,
    <span style="color: #808000; text-decoration-color: #808000">directory</span>=<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">PosixPath</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'/home/rhut/repos/teaching-materials/teaching-files/Forcing/RhineForcing2000-2002'</span><span style="font-weight: bold">)</span>,
    <span style="color: #808000; text-decoration-color: #808000">shape</span>=<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">PosixPath</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'/home/rhut/repos/teaching-materials/teaching-files/Forcing/RhineForcing2000-2002/Rhine.shp'</span><span style="font-weight: bold">)</span>,
    <span style="color: #808000; text-decoration-color: #808000">filenames</span>=<span style="font-weight: bold">{</span>
        <span style="color: #008000; text-decoration-color: #008000">'pr'</span>: <span style="color: #008000; text-decoration-color: #008000">'OBS6_ERA5_reanaly_1_day_pr_2000-2002.nc'</span>,
        <span style="color: #008000; text-decoration-color: #008000">'tas'</span>: <span style="color: #008000; text-decoration-color: #008000">'OBS6_ERA5_reanaly_1_day_tas_2000-2002.nc'</span>,
        <span style="color: #008000; text-decoration-color: #008000">'rsds'</span>: <span style="color: #008000; text-decoration-color: #008000">'OBS6_ERA5_reanaly_1_day_rsds_2000-2002.nc'</span>,
        <span style="color: #008000; text-decoration-color: #008000">'evspsblpot'</span>: <span style="color: #008000; text-decoration-color: #008000">'Derived_Makkink_evspsblpot.nc'</span>
    <span style="font-weight: bold">}</span>
<span style="font-weight: bold">)</span>
</pre>
</div></div>
</div>
<p>Now we can prepare the configuration files just as in the first notebook. Note that we are using the same parameters as in the first notebook which will not be adequete for your new area (but might be pretty ok, let’s see!):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">100</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">5</span><span class="p">])</span>

<span class="n">p_min_initial</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span>   <span class="mf">0.2</span><span class="p">,</span>  <span class="mi">40</span><span class="p">,</span>    <span class="mf">.5</span><span class="p">,</span>   <span class="mf">.001</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span>     <span class="mf">.01</span><span class="p">,</span>  <span class="mf">.0001</span><span class="p">])</span>
<span class="n">p_max_initial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">8</span><span class="p">,</span>    <span class="mi">1</span><span class="p">,</span>  <span class="mi">800</span><span class="p">,</span>   <span class="mi">4</span><span class="p">,</span>    <span class="mf">.3</span><span class="p">,</span>     <span class="mi">10</span><span class="p">,</span>    <span class="mf">.1</span><span class="p">,</span>   <span class="mf">.01</span><span class="p">])</span>

<span class="n">p_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;$I_</span><span class="si">{max}</span><span class="s2">$&quot;</span><span class="p">,</span>  <span class="s2">&quot;$C_e$&quot;</span><span class="p">,</span>  <span class="s2">&quot;$Su_</span><span class="si">{max}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="s2">&quot;β&quot;</span><span class="p">,</span>  <span class="s2">&quot;$P_</span><span class="si">{max}</span><span class="s2">$&quot;</span><span class="p">,</span>  <span class="s2">&quot;$T_</span><span class="si">{lag}</span><span class="s2">$&quot;</span><span class="p">,</span>   <span class="s2">&quot;$K_f$&quot;</span><span class="p">,</span>   <span class="s2">&quot;$K_s$&quot;</span><span class="p">]</span>
<span class="n">S_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Interception storage&quot;</span><span class="p">,</span> <span class="s2">&quot;Unsaturated Rootzone Storage&quot;</span><span class="p">,</span> <span class="s2">&quot;Fastflow storage&quot;</span><span class="p">,</span> <span class="s2">&quot;Groundwater storage&quot;</span><span class="p">]</span>

<span class="n">param_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Imax&quot;</span><span class="p">,</span><span class="s2">&quot;Ce&quot;</span><span class="p">,</span>  <span class="s2">&quot;Sumax&quot;</span><span class="p">,</span> <span class="s2">&quot;beta&quot;</span><span class="p">,</span>  <span class="s2">&quot;Pmax&quot;</span><span class="p">,</span>  <span class="s2">&quot;Tlag&quot;</span><span class="p">,</span>   <span class="s2">&quot;Kf&quot;</span><span class="p">,</span>   <span class="s2">&quot;Ks&quot;</span><span class="p">]</span>

<span class="n">par_0</span> <span class="o">=</span> <span class="p">(</span><span class="n">p_min_initial</span> <span class="o">+</span> <span class="n">p_max_initial</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">s_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">100</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">5</span><span class="p">])</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">p_min_initial</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span>   <span class="mf">0.2</span><span class="p">,</span>  <span class="mi">40</span><span class="p">,</span>    <span class="mf">.5</span><span class="p">,</span>   <span class="mf">.001</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span>     <span class="mf">.01</span><span class="p">,</span>  <span class="mf">.0001</span><span class="p">])</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">p_max_initial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">8</span><span class="p">,</span>    <span class="mi">1</span><span class="p">,</span>  <span class="mi">800</span><span class="p">,</span>   <span class="mi">4</span><span class="p">,</span>    <span class="mf">.3</span><span class="p">,</span>     <span class="mi">10</span><span class="p">,</span>    <span class="mf">.1</span><span class="p">,</span>   <span class="mf">.01</span><span class="p">])</span>

<span class="ne">NameError</span>: name &#39;np&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">HBV</span><span class="p">(</span><span class="n">forcing</span><span class="o">=</span><span class="n">ERA5_forcing</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">config_file</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span>
                            <span class="n">parameters</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">par_0</span><span class="p">]),</span>
                            <span class="n">initial_storage</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">s_0</span><span class="p">]),</span>
                               <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/rhut/repos/teaching-materials/teaching-files/hbv_bmi.py:57: UserWarning: Converting non-nanosecond precision datetime values to nanosecond precision. This behavior can eventually be relaxed in xarray, as it is an artifact from pandas which is now beginning to support non-nanosecond precision values. This warning is caused by passing non-nanosecond np.datetime64 or np.timedelta64 values to the DataArray or Variable constructor; it can be silenced by converting the values to nanosecond precision ahead of time.
</pre></div>
</div>
</div>
</div>
<p>Now it is time again to run the HBV model:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q_m</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">time</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">while</span> <span class="n">model</span><span class="o">.</span><span class="n">time</span> <span class="o">&lt;</span> <span class="n">model</span><span class="o">.</span><span class="n">end_time</span><span class="p">:</span>
    <span class="n">model</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
    <span class="n">discharge_this_timestep</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="s2">&quot;Q&quot;</span><span class="p">)</span>
    <span class="n">Q_m</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">discharge_this_timestep</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">time</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">time_as_datetime</span><span class="o">.</span><span class="n">date</span><span class="p">()))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">Q_m</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Modeled discharge&quot;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="n">time</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can plot the output discharge directly using the DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Modeled discharge HBV-bmi&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Discharge (</span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">bmi</span><span class="o">.</span><span class="n">get_var_units</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;Time&#39;)
</pre></div>
</div>
<img alt="../_images/51c97978c36ff8f3509368c69588b7b05639d131fbdbc1d86efec6896553bdcb.png" src="../_images/51c97978c36ff8f3509368c69588b7b05639d131fbdbc1d86efec6896553bdcb.png" />
</div>
</div>
<section id="analyse-results">
<h2>Analyse results<a class="headerlink" href="#analyse-results" title="Link to this heading">#</a></h2>
<p>We can also use the <code class="docutils literal notranslate"><span class="pre">hydrograph</span></code> function from eWaterCycle. This will make a hydrograph that compares model output to observations. For this we need to load observations and make sure that the observations and model output are in the same units. Observations typically are in m<span class="math notranslate nohighlight">\(^3\)</span>/s.</p>
<p>Note that the unit of discharge from this model is in mm/d. Conversion to m<span class="math notranslate nohighlight">\(^3\)</span>/s requires the area of the catchment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">shapeObject</span> <span class="o">=</span> <span class="n">shapereader</span><span class="o">.</span><span class="n">Reader</span><span class="p">(</span><span class="n">shapeFile</span><span class="o">.</span><span class="n">absolute</span><span class="p">())</span>
<span class="n">record</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">shapeObject</span><span class="o">.</span><span class="n">records</span><span class="p">())</span>
<span class="n">shape_area</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="s2">&quot;SUB_AREA&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The catchment area is:&quot;</span><span class="p">,</span> <span class="n">shape_area</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">The catchment area is: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">163122500000.0</span>
</pre>
</div></div>
</div>
<p>The hydrograph function requires DataFrames, so we use the DataFrame <code class="docutils literal notranslate"><span class="pre">df</span></code> and convert the discharge to m<span class="math notranslate nohighlight">\(^3\)</span> per second.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;model output&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;model output&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">shape_area</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1000</span> <span class="o">*</span> <span class="mi">86400</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The observation data is loaded using <code class="docutils literal notranslate"><span class="pre">the</span> <span class="pre">get_grdc_data()</span></code> function build into eWaterCycle. The observation data and discharge data are combined together into one DataFrame. Note that we re-index the discharge data to make sure they are at the same timestamp.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">observations_df</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">ewatercycle</span><span class="o">.</span><span class="n">observation</span><span class="o">.</span><span class="n">grdc</span><span class="o">.</span><span class="n">get_grdc_data</span><span class="p">(</span>
    <span class="n">station_id</span><span class="o">=</span><span class="n">grdc_station_id</span><span class="p">,</span>
    <span class="n">start_time</span><span class="o">=</span><span class="n">experiment_start_time</span><span class="p">,</span>
    <span class="n">end_time</span><span class="o">=</span><span class="n">experiment_end_time</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">grdc_obs</span> <span class="o">=</span> <span class="n">observations_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;streamflow&quot;</span><span class="p">:</span> <span class="s2">&quot;Observations from GRDC&quot;</span><span class="p">})</span>
<span class="n">grdc_lon</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;grdc_longitude_in_arc_degree&quot;</span><span class="p">]</span>
<span class="n">grdc_lat</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;grdc_latitude_in_arc_degree&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Have a look at the DataFrame with the model output and the observations from GRDC:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hydro_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">discharge_dataframe</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">grdc_obs</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;ffill&#39;</span><span class="p">),</span> <span class="n">grdc_obs</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">hydro_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>model output</th>
      <th>Observations from GRDC</th>
    </tr>
    <tr>
      <th>time</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>NaN</td>
      <td>6010.0</td>
    </tr>
    <tr>
      <th>2000-01-02</th>
      <td>2.667401</td>
      <td>5330.0</td>
    </tr>
    <tr>
      <th>2000-01-03</th>
      <td>10.675073</td>
      <td>4700.0</td>
    </tr>
    <tr>
      <th>2000-01-04</th>
      <td>24.033886</td>
      <td>4260.0</td>
    </tr>
    <tr>
      <th>2000-01-05</th>
      <td>38.016808</td>
      <td>3980.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2002-12-27</th>
      <td>3813.967532</td>
      <td>4560.0</td>
    </tr>
    <tr>
      <th>2002-12-28</th>
      <td>3808.252888</td>
      <td>4420.0</td>
    </tr>
    <tr>
      <th>2002-12-29</th>
      <td>3809.663991</td>
      <td>4350.0</td>
    </tr>
    <tr>
      <th>2002-12-30</th>
      <td>3893.127421</td>
      <td>4310.0</td>
    </tr>
    <tr>
      <th>2002-12-31</th>
      <td>4090.049172</td>
      <td>4690.0</td>
    </tr>
  </tbody>
</table>
<p>1096 rows × 2 columns</p>
</div></div></div>
</div>
<p>Finally plot the hydrograph. It is remarkabe to see how well a simple model like HBV, without calibration, is already able to predict discharge in the Rhine. Is it also good for your own area?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot hydrograph and show metrics</span>
<span class="n">ewatercycle</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">hydrograph</span><span class="p">(</span><span class="n">hydro_data</span><span class="p">,</span> <span class="n">reference</span><span class="o">=</span><span class="s1">&#39;Observations from GRDC&#39;</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;experiment_hydrograph.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/envs/ewatercycle2/lib/python3.10/site-packages/HydroErr/HydroErr.py:6248: UserWarning: Row(s) [0] contained NaN values and the row(s) have been removed (Rows are zero indexed).
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1000x1000 with 2 Axes&gt;,
 (&lt;Axes: title={&#39;center&#39;: &#39;Hydrograph&#39;}, xlabel=&#39;time&#39;, ylabel=&#39;Discharge (m$^3$ s$^{-1}$)&#39;&gt;,
  &lt;Axes: &gt;))
</pre></div>
</div>
<img alt="../_images/97cb6db9ed6c9fb1860d681e76f372625ae37bcffeae27ef5d151e9171177a99.png" src="../_images/97cb6db9ed6c9fb1860d681e76f372625ae37bcffeae27ef5d151e9171177a99.png" />
</div>
</div>
<p>It is good practice to remove a model object when done using <code class="docutils literal notranslate"><span class="pre">.finalize()</span></code>. For small models like this, it doesn’t matter too much, but larger models that run in containers keep using resources when not <code class="docutils literal notranslate"><span class="pre">finalized</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

        <script type="text/x-thebe-config">
        {
            "rootPath": "..",
            "requestKernel": true,
            "useJupyterLite": true,
            "useBinder": false,
            "kernelOptions": {
                "path": "/"
            },
            "codeMirrorConfig": {
                "theme": "default",
                "mode": "python"
            },
            "mountRestartButton": false,
            "mountRestartallButton": false
        }
        </script>
        <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="exercise2_generate_ERA5_forcing_for_HBV.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Exercise 2. Generate forcing for any region from ERA5 for HBV model</p>
      </div>
    </a>
    <a class="right-next"
       href="exercise4_calibrate_HBV_eWaterCycle.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Exercise 4: Calibrate HBV model with ERA5 forcing and GRDC observation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analyse-results">Analyse results</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Teaching Material by Markus Hrachowitz (TU Delft). eWaterCycle platform by Rolf Hut (TU Delft), Bart Schilperoort (Netherlands eScience Center) and the bigger ewaterCycle team, including much work building the jupyter book by Anne Verslijen, Ahmed Farahat and Ezzat Qadriyeh. Jupyter book version uilt with <a href="https://teachbooks.tudelft.nl/">TeachBooks</a> and <a href="https://jupyterbook.org/">Jupyter Book</a>, <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="license noopener noreferrer"">CC BY 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg" alt=""></a>
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on February 4, 2025.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>